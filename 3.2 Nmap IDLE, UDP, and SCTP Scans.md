## ğŸ” 1. IDLE/IPID Scan (nmap -sI) â€“ Zombie Scan

### ğŸ§  What is it?
An advanced stealth scan that uses a third-party "zombie" host to perform the scan indirectly. The attacker hides their IP by spoofing the zombieâ€™s IP.

### ğŸ“š How It Works:
1. Attacker sends SYN-ACK to Zombie â†’ Zombie replies with RST.
2. Attacker checks the IPID value from the Zombie's RST packet.
3. Attacker sends a SYN to the Target, spoofing the Zombieâ€™s IP.
4. Target replies to Zombie:
   - If port is **open**, target sends SYN-ACK â†’ Zombie replies with RST â†’ IPID **increases**
   - If port is **closed**, target sends RST â†’ No change in IPID
5. Attacker checks Zombie's IPID again to infer port status.

### Command:
```bash
nmap -Pn -p <port> -sI <ZombieIP> <TargetIP> --packet-trace
```

### ğŸ“Œ CEH Key Points:
- Stealth scan â€“ avoids detection and hides the attacker's identity
- Requires an idle host with predictable IPID sequence
- Can bypass firewalls and logging systems

---

## ğŸ“¶ 2. UDP Scan (nmap -sU)

### ğŸ§  What is it?
Used to scan for open **UDP services**, which are connectionless (unlike TCP). Important for discovering services like DNS, SNMP, TFTP, etc.

### ğŸ” How It Works:
- Sends a UDP packet to a target port:
  - **No response** = Port is likely open or filtered
  - **ICMP Port Unreachable** = Port is closed
  - **ICMP Type 3 Code 1/2/3/9/10/13** = Port is filtered

### Command:
```bash
nmap -sU <target>
```

### ğŸ“Œ CEH Key Points:
- No 3-way handshake â€“ UDP is connectionless
- Requires admin/root privileges
- Common with ports like 53 (DNS), 161 (SNMP), 69 (TFTP)
- Very slow â€“ prone to timeouts and retries

---

## âš™ï¸ 3. SCTP INIT Scan (nmap -sY) and COOKIE ECHO Scan (nmap -sZ)

### ğŸ§  What is SCTP?
**Stream Control Transmission Protocol (SCTP)** is a transport layer protocol used in telecom, VoIP, and signaling networks. It uses a **4-step handshake**.

### ğŸ”¹ SCTP Handshake Process:
1. Host1 â†’ INIT â†’ Host2
2. Host2 â†’ INIT-ACK â†’ Host1
3. Host1 â†’ COOKIE ECHO â†’ Host2
4. Host2 â†’ COOKIE-ACK â†’ Host1

---

### ğŸ”¸ SCTP INIT Scan (nmap -sY)

### How It Works:
- Sends an INIT chunk to a target SCTP port
- **INIT-ACK** = Port is open
- **ABORT** = Port is closed

### Command:
```bash
nmap -sY <target>
```

---

### ğŸ”¸ SCTP COOKIE ECHO Scan (nmap -sZ)

### How It Works:
- Sends COOKIE ECHO (step 3 of the handshake)
- Responses can indicate whether the port is accepting connections

### Command:
```bash
nmap -sZ <target>
```

---

### ğŸ“Œ CEH Key Points:
- Use when working with telecom or VoIP infrastructure
- Requires root privileges
- INIT-ACK = Open, ABORT = Closed
- Less common, but included in CEH syllabus

---

## ğŸ§  Summary Table

| Scan Type        | Nmap Flag | Purpose                          | Response Behavior                         | Privileges |
|------------------|-----------|----------------------------------|-------------------------------------------|------------|
| IDLE/IPID        | -sI       | Stealth port scan using Zombie   | Inferred via Zombie IPID changes          | Yes        |
| UDP Scan         | -sU       | Scan for UDP services            | No response = open; ICMP unreachable = closed | Yes    |
| SCTP INIT        | -sY       | Discover open SCTP ports         | INIT-ACK = open; ABORT = closed           | Yes        |
| COOKIE ECHO      | -sZ       | SCTP scan (3rd handshake step)   | Analyzes COOKIE-ACK behavior              | Yes        |

---

## ğŸ“š Additional Resources

- [Nmap Scan Types](https://nmap.org/book/man-port-scanning-techniques.html)
- [CEH Blueprint](https://www.eccouncil.org/train-certify/certified-ethical-hacker-ceh/)
- [SCTP RFC Overview](https://datatracker.ietf.org/doc/html/rfc4960)
- [ICMP Response Codes - Wikipedia](https://en.wikipedia.org/wiki/Internet_Control_Message_Protocol#Control_messages)

---

âœ… **CEH Exam Tips**:
- IDLE scans rely on IPID sequence â€“ stealthy, no direct contact
- UDP scans are slow and rely on ICMP responses
- SCTP is a niche topic but appears in CEH â€“ learn INIT and COOKIE ECHO behavior
- Know which scans require root access and how responses determine port states

